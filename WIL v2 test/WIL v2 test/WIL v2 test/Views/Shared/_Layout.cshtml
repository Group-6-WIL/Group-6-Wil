<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/WIL_V1.styles.css" asp-append-version="true" />
    <title>@ViewData["Title"] - Ladybird Foundation</title>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-transparent">
            <!-- Navbar items -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Main menu items -->
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color:white; font-size:large; font-weight: bold"
                           data-white-icon="@(Url.Content("~/images/menu2 - white.png"))"
                           data-black-icon="@(Url.Content("~/images/menu2 - black.png"))">
                            <img id="menuIcon" src="~/images/menu2 - white.png" alt="Menu Icon" style="width: 35px; height: 35px; margin-right: 5px;" />
                            Menu
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown" style="background:white">
                            <a class="dropdown-item" href="@Url.Action("Index", "Home")" style="color:black">Home</a>
                            <a class="dropdown-item" href="Events" style="color:black">Events</a>
                            <a class="dropdown-item" href="AboutUs" style="color:black">About Us</a>
                            <a class="dropdown-item" id="donationLink" href="Donations" style="color:black">Donations</a>

                            <script>
                                // Check if the user is authenticated using JavaScript
                                var isAuthenticated = @(User.Identity.IsAuthenticated.ToString().ToLower());

                                // Modify the link behavior based on authentication status
                                var donationLink = document.getElementById("donationLink");
                                donationLink.addEventListener("click", function (event) {
                                    if (!isAuthenticated) {
                                        event.preventDefault();
                                        // Redirect to the login page if not authenticated
                                        window.location.href = "Identity/Account/Login"; // Adjust the URL as needed
                                    }
                                });
                            </script>
                            <a class="dropdown-item" href="Locations" style="color:black">Location</a>
                            <a class="dropdown-item" href="ContactUs" style="color:black">Contact Us</a>
                            @* IF USER= ADMIN *@
                            @* @if (User.IsInRole("Admin"))
                            { *@
                            <!-- Only show the "Admin Dashboard" link if the user is in the "Admin" role -->
                            <a class="dropdown-item" asp-controller="Dashboard" style="color:black">Dashboard</a>
                            @* } *@
                        </div>
                    </li>
                </ul>

                <!-- Login partial -->
                <div class="container d-flex justify-content-end" style="color:white">
                    <partial name="_LoginPartial" />
                </div>
            </div>
        </nav>
    </header>
    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    <footer class="footer text-muted">
        <div class="container">
            | Contact us : | <img src="~/images/phone_icon.png" /> +27 79 076 2234 | Michelle
        </div>
    </footer>

    <!-- Manually include Popper.js and Bootstrap's JavaScript files -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.2/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Script to change menu icon and text color based on page -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var currentPath = window.location.pathname;
            var menuLink = document.getElementById("navbarDropdown");
            var menuIcon = document.getElementById("menuIcon");

            if (currentPath !== '/' && currentPath !== '/Home/Index') {
                menuLink.style.color = "black";
                menuIcon.src = menuLink.getAttribute("data-black-icon");
            } else {
                menuLink.style.color = "white";
                menuIcon.src = menuLink.getAttribute("data-white-icon");
            }

            // Change the color of the register and login links
            var registerLink = document.getElementById("registerLink");
            var loginLink = document.getElementById("loginLink");

            if (registerLink && loginLink) {
                if (currentPath !== '/' && currentPath !== '/Home/Index') {
                    registerLink.style.color = registerLink.getAttribute("data-dark-color");
                    loginLink.style.color = loginLink.getAttribute("data-dark-color");
                } else {
                    registerLink.style.color = registerLink.getAttribute("data-light-color");
                    loginLink.style.color = loginLink.getAttribute("data-light-color");
                }
            }
        });
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
